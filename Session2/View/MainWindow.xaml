<Window x:Class="Desktop.View.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:materialIcons ="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:converter ="clr-namespace:Desktop.Helpers"
        xmlns:vm ="clr-namespace:Desktop.ViewModel"
        xmlns:view ="clr-namespace:Desktop.View" 
        xmlns:local="clr-namespace:Desktop.View"
        mc:Ignorable="d"
        Title="Организационная структура" Height="450" Width="900"  WindowStyle="None"
        Left="250"
        Top="100"
        WindowState="{Binding WindowState}"
        >
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>
    <Window.Resources>
        <converter:IdDepartmentToName x:Key="IdDepartmenttoName"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="2*"/>
            <RowDefinition Height="8*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <Grid Grid.Row="0" Grid.ColumnSpan="2" Background="#78B24B">
            
            <Grid.RowDefinitions>
                <RowDefinition Height="3*"/>
                <RowDefinition Height="5.5*"/>
            </Grid.RowDefinitions>
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="8*"/>
                </Grid.ColumnDefinitions>
                <Image Grid.Column="0"  Margin="10 10 10 10 " Source="/Assets/Logo.png" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                <Border Grid.Column="1" Margin="30 0 40 10" Height="50"
                Background="White" CornerRadius="10">
                        <TextBlock Padding="15 10 0 0"  Text="{Binding TitleWindow}" 
                     FontSize="20" Background="Transparent" TextAlignment="Left" LineHeight="50" 
                     HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>    
                </Border> 
            </Grid>

            <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Width="50" Height="60" Command="{Binding StateminCommand}" 
                    Background="Transparent" BorderBrush="Transparent" 
                    Foreground="White" Content="{materialIcons:MaterialIconExt Kind=Minus, Size=20}" 
                    VerticalContentAlignment="Top" VerticalAlignment="Top" HorizontalContentAlignment="Right" 
                    HorizontalAlignment="Right" Margin="0 0 0 10"/>
                <Button Width="50" Height="60" Command="{Binding StatemaxCommand}" 
                    Background="Transparent" BorderBrush="Transparent" 
                    Foreground="White" Content="{materialIcons:MaterialIconExt Kind=Maximize, Size=20}" 
                    VerticalContentAlignment="Top" VerticalAlignment="Top" HorizontalContentAlignment="Right" 
                    HorizontalAlignment="Right" Margin="0 0 0 10"/>     
                
                <Button  Width="50" Height="50" Background="Transparent"
                         BorderBrush="Transparent" Foreground="White" 
                         Content="{materialIcons:MaterialIconExt Kind=Close, Size=20}" 
                         VerticalContentAlignment="Top" HorizontalContentAlignment="Right"
                         HorizontalAlignment="Right" VerticalAlignment="Top" 
                         Command="{Binding CloseWindowCommand}"
                         ></Button>
                
                
            </StackPanel>
            
        </Grid>
        <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Visible" VerticalScrollBarVisibility="Visible">
            <Canvas x:Name="MainCanvas" ScrollViewer.CanContentScroll="True"  ScrollViewer.HorizontalScrollBarVisibility="Visible"  
                    ScrollViewer.VerticalScrollBarVisibility="Visible"
                    Background="LightGray" Width="10000" Height="10000" DataContext="{Binding GraphVM}">
                <ItemsControl ItemsSource="{Binding Nodes}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <Canvas Background="Transparent"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemContainerStyle>
                        <Style TargetType="ContentPresenter">
                            <Setter Property="Canvas.Left" Value="{Binding X}"/>
                            <Setter Property="Canvas.Top" Value="{Binding Y}"/>
                            <Setter Property="Width" Value="150"/>
                            <Setter Property="Height" Value="60"/>
                        </Style>
                    </ItemsControl.ItemContainerStyle>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <view:VertexControl/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

            </Canvas>
        </ScrollViewer>
        <Grid Grid.Row="1" Grid.Column="1" Margin="10" Background="LightGray">
            <Grid.RowDefinitions>
                <RowDefinition Height="80*"/>
                <RowDefinition Height="50"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="8*"/>
                <ColumnDefinition Width="50"/>
            </Grid.ColumnDefinitions>
            <ListBox Grid.Row="0" Grid.ColumnSpan="2" x:Name="EmployerList" ItemsSource="{Binding EmployeesList}" SelectedItem="{Binding SelectedEmployee}">
                <i:Interaction.Triggers>
                    <!---->
                    <i:EventTrigger EventName="MouseDoubleClick">
                        <i:InvokeCommandAction Command="{Binding EditCommand}" CommandParameter="{Binding SelectedEmployee}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="IsEnabled" Value="{Binding Disabled}"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Disabled}" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                                <Setter Property="Background" Value="LightGray"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Width="900" Background="{Binding Color}" >
                            <StackPanel Orientation="Horizontal" >
                                <Label Content="{Binding IdDepartment, Converter={StaticResource IdDepartmenttoName}}" Foreground="white"/>
                                <Label Content=" - " Foreground="white"/>
                                <Label Content="{Binding Position}" Foreground="white"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" >
                                <Label Content="{Binding Surname}" FontSize="20" Foreground="white"/>
                                <Label Content="{Binding FirstName}" FontSize="20" Foreground="white"/>
                                <Label Content="{Binding SecondName}" FontSize="20" Foreground="white"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" >
                                <Label Content="{Binding PhoneWork}" Foreground="white"/>
                                <Label Content="{Binding Email}" Foreground="white"/>
                            </StackPanel>
                            
                            <Label Content="{Binding Cabinet}" Foreground="white"/>
                        </StackPanel>
                        
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
            <Button Grid.Row="1" Grid.Column ="1"  HorizontalAlignment="Stretch" Content="+" Margin="5" Background="#78B24B" BorderThickness="0" Command="{Binding AddEmployeeCommand}"/>
        </Grid>
    </Grid>
</Window>
